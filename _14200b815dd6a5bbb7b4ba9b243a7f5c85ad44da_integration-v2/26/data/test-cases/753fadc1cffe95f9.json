{"uid":"753fadc1cffe95f9","name":"test_build_assert_equal","fullName":"tests.functional.adapter.utils.test_utils.TestDateDiff#test_build_assert_equal","historyId":"ead8cf0793ac52908f5371b3d16eecb1","time":{"start":1724322674087,"stop":1724322674922,"duration":835},"status":"broken","statusMessage":"dbt.exceptions.CompilationError: Compilation Error in model test_datediff (models/test_datediff.sql)\n  expected token ',', got 'integer'\n    line 25\n      union all select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'second') }} as actual, 1 as expected","statusTrace":"node = ModelNode(database='integration_testing__1724321556329', schema='public', name='test_datediff', resource_type=<NodeTyp...Protected: 'protected'>, constraints=[], version=None, latest_version=None, deprecation_date=None, defer_relation=None)\n\n    @contextmanager\n    def catch_jinja(node=None) -> Iterator[None]:\n        try:\n>           yield\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:514: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:541: in get_template\n    return env.from_string(template_source, globals=ctx)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/jinja2/environment.py:1108: in from_string\n    return cls.from_code(self, self.compile(source), gs, None)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/jinja2/environment.py:768: in compile\n    self.handle_exception(source=source_hint)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <dbt.clients.jinja.MacroFuzzEnvironment object at 0x7ffa6bb51b20>\nsource = \"with data as (\\n\\n    select * from {{ ref('data_datediff') }}\\n\\n)\\n\\nselect\\n\\n    case\\n        when datepart = 's...select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'year') }} as actual, 1 as expected\"\n\n    def handle_exception(self, source: t.Optional[str] = None) -> \"te.NoReturn\":\n        \"\"\"Exception handling helper.  This is used internally to either raise\n        rewritten exceptions or return a rendered traceback for the template.\n        \"\"\"\n        from .debug import rewrite_traceback_stack\n    \n>       raise rewrite_traceback_stack(source=source)\nE       jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'integer'\nE         line 25\nE           union all select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'second') }} as actual, 1 as expected\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/jinja2/environment.py:939: TemplateSyntaxError\n\nThe above exception was the direct cause of the following exception:\n\nself = <test_utils.TestDateDiff object at 0x7ffa732619d0>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7ffa74989c40>\n\n    def test_build_assert_equal(self, project):\n>       run_dbt([\"build\"])  # seed, model, test\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/utils/base_utils.py:55: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:105: in run_dbt\n    raise res.exception\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:91: in wrapper\n    result, success = func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:76: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:169: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:198: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:245: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:271: in wrapper\n    ctx.obj[\"manifest\"] = parse_manifest(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:1790: in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:318: in get_full_manifest\n    manifest = loader.load()\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:478: in load\n    self.parse_project(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:674: in parse_project\n    parser.parse_file(block)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:483: in parse_file\n    self.parse_node(file_block)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:444: in parse_node\n    self.render_update(node, config)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/models.py:360: in render_update\n    super().render_update(node, config)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:420: in render_update\n    context = self.render_with_context(node, config)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:269: in render_with_context\n    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:592: in get_rendered\n    template = get_template(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:541: in get_template\n    return env.from_string(template_source, globals=ctx)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/contextlib.py:137: in __exit__\n    self.gen.throw(typ, value, traceback)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nnode = ModelNode(database='integration_testing__1724321556329', schema='public', name='test_datediff', resource_type=<NodeTyp...Protected: 'protected'>, constraints=[], version=None, latest_version=None, deprecation_date=None, defer_relation=None)\n\n    @contextmanager\n    def catch_jinja(node=None) -> Iterator[None]:\n        try:\n            yield\n        except jinja2.exceptions.TemplateSyntaxError as e:\n            e.translated = False\n>           raise CompilationError(str(e), node) from e\nE           dbt.exceptions.CompilationError: Compilation Error in model test_datediff (models/test_datediff.sql)\nE             expected token ',', got 'integer'\nE               line 25\nE                 union all select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'second') }} as actual, 1 as expected\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:517: CompilationError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"shared_data_dir","time":{"start":1724321589759,"stop":1724321589759,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmpdir_factory","time":{"start":1724321589759,"stop":1724321589759,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data_dir","time":{"start":1724322630985,"stop":1724322630985,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_root","time":{"start":1724322673309,"stop":1724322673310,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clean_up_logging","time":{"start":1724322673309,"stop":1724322673309,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_root","time":{"start":1724322673310,"stop":1724322673311,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_config_update","time":{"start":1724322673311,"stop":1724322673311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"prefix","time":{"start":1724322673311,"stop":1724322673311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_target","time":{"start":1724322673311,"stop":1724322673311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml","time":{"start":1724322673311,"stop":1724322673312,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1724322673311,"stop":1724322673311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_data","time":{"start":1724322673311,"stop":1724322673311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_project_yml","time":{"start":1724322673312,"stop":1724322673313,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1724322673312,"stop":1724322673312,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies","time":{"start":1724322673313,"stop":1724322673313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies_yml","time":{"start":1724322673313,"stop":1724322673313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors_yml","time":{"start":1724322673313,"stop":1724322673313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages","time":{"start":1724322673313,"stop":1724322673313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter","time":{"start":1724322673313,"stop":1724322673779,"duration":466},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors","time":{"start":1724322673313,"stop":1724322673313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages_yml","time":{"start":1724322673313,"stop":1724322673313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"models","time":{"start":1724322673780,"stop":1724322673780,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"macros","time":{"start":1724322673780,"stop":1724322673780,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"properties","time":{"start":1724322673780,"stop":1724322673780,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"analyses","time":{"start":1724322673780,"stop":1724322673780,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"snapshots","time":{"start":1724322673780,"stop":1724322673780,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tests","time":{"start":1724322673780,"stop":1724322673780,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_files","time":{"start":1724322673780,"stop":1724322673781,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1724322673780,"stop":1724322673780,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_config","time":{"start":1724322673781,"stop":1724322673781,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project","time":{"start":1724322673781,"stop":1724322674086,"duration":305},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir","time":{"start":1724322673781,"stop":1724322673781,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1724322736687,"stop":1724322736687,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"macros","time":{"start":1724322743938,"stop":1724322743938,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"dbt.exceptions.CompilationError: Compilation Error in model test_datediff (models/test_datediff.sql)\n  expected token ',', got 'integer'\n    line 25\n      union all select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'second') }} as actual, 1 as expected","statusTrace":"node = ModelNode(database='integration_testing__1724321556329', schema='public', name='test_datediff', resource_type=<NodeTyp...Protected: 'protected'>, constraints=[], version=None, latest_version=None, deprecation_date=None, defer_relation=None)\n\n    @contextmanager\n    def catch_jinja(node=None) -> Iterator[None]:\n        try:\n>           yield\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:514: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:541: in get_template\n    return env.from_string(template_source, globals=ctx)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/jinja2/environment.py:1108: in from_string\n    return cls.from_code(self, self.compile(source), gs, None)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/jinja2/environment.py:768: in compile\n    self.handle_exception(source=source_hint)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <dbt.clients.jinja.MacroFuzzEnvironment object at 0x7ffa6bb51b20>\nsource = \"with data as (\\n\\n    select * from {{ ref('data_datediff') }}\\n\\n)\\n\\nselect\\n\\n    case\\n        when datepart = 's...select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'year') }} as actual, 1 as expected\"\n\n    def handle_exception(self, source: t.Optional[str] = None) -> \"te.NoReturn\":\n        \"\"\"Exception handling helper.  This is used internally to either raise\n        rewritten exceptions or return a rendered traceback for the template.\n        \"\"\"\n        from .debug import rewrite_traceback_stack\n    \n>       raise rewrite_traceback_stack(source=source)\nE       jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'integer'\nE         line 25\nE           union all select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'second') }} as actual, 1 as expected\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/jinja2/environment.py:939: TemplateSyntaxError\n\nThe above exception was the direct cause of the following exception:\n\nself = <test_utils.TestDateDiff object at 0x7ffa732619d0>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7ffa74989c40>\n\n    def test_build_assert_equal(self, project):\n>       run_dbt([\"build\"])  # seed, model, test\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/utils/base_utils.py:55: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:105: in run_dbt\n    raise res.exception\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:91: in wrapper\n    result, success = func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:76: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:169: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:198: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:245: in wrapper\n    return func(*args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/cli/requires.py:271: in wrapper\n    ctx.obj[\"manifest\"] = parse_manifest(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:1790: in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:318: in get_full_manifest\n    manifest = loader.load()\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:478: in load\n    self.parse_project(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/manifest.py:674: in parse_project\n    parser.parse_file(block)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:483: in parse_file\n    self.parse_node(file_block)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:444: in parse_node\n    self.render_update(node, config)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/models.py:360: in render_update\n    super().render_update(node, config)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:420: in render_update\n    context = self.render_with_context(node, config)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/parser/base.py:269: in render_with_context\n    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:592: in get_rendered\n    template = get_template(\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:541: in get_template\n    return env.from_string(template_source, globals=ctx)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/contextlib.py:137: in __exit__\n    self.gen.throw(typ, value, traceback)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nnode = ModelNode(database='integration_testing__1724321556329', schema='public', name='test_datediff', resource_type=<NodeTyp...Protected: 'protected'>, constraints=[], version=None, latest_version=None, deprecation_date=None, defer_relation=None)\n\n    @contextmanager\n    def catch_jinja(node=None) -> Iterator[None]:\n        try:\n            yield\n        except jinja2.exceptions.TemplateSyntaxError as e:\n            e.translated = False\n>           raise CompilationError(str(e), node) from e\nE           dbt.exceptions.CompilationError: Compilation Error in model test_datediff (models/test_datediff.sql)\nE             expected token ',', got 'integer'\nE               line 25\nE                 union all select {{ datediff(''1999-12-31 23:59:59.999999'', ''2000-01-01 00:00:00.000000'', 'second') }} as actual, 1 as expected\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/clients/jinja.py:517: CompilationError","steps":[],"attachments":[{"uid":"771a71792848e6c9","name":"log","source":"771a71792848e6c9.txt","type":"text/plain","size":11642},{"uid":"49a1a77023b71228","name":"stdout","source":"49a1a77023b71228.txt","type":"text/plain","size":667}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"project::0","time":{"start":1724322675185,"stop":1724322678199,"duration":3014},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir::0","time":{"start":1724322678200,"stop":1724322678200,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter::0","time":{"start":1724322678202,"stop":1724322678202,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml::0","time":{"start":1724322678204,"stop":1724322678204,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter.utils"},{"name":"suite","value":"test_utils"},{"name":"subSuite","value":"TestDateDiff"},{"name":"host","value":"fv-az1986-173"},{"name":"thread","value":"2163-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.utils.test_utils"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"753fadc1cffe95f9.json","parameterValues":[]}