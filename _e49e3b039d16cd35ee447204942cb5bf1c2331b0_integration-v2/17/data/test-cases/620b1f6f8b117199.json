{"uid":"620b1f6f8b117199","name":"test_expected_actual","fullName":"tests.functional.adapter.utils.test_utils.TestArrayConcat#test_expected_actual","historyId":"5ec14aee96d00e6f9fcafff4cbca2191","time":{"start":1721923662110,"stop":1721923666567,"duration":4457},"status":"failed","statusMessage":"AssertionError: Got 6 different rows between expected and actual","statusTrace":"self = <test_utils.TestArrayConcat object at 0x7ff16c6d9460>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7ff1693f9640>\n\n    def test_expected_actual(self, project):\n        run_dbt([\"build\"])\n    \n        # check contents equal\n>       check_relations_equal(project.adapter, [\"expected\", \"actual\"])\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/utils/base_array_utils.py:15: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:407: in check_relations_equal\n    return check_relations_equal_with_relations(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nadapter = <dbt.adapters.firebolt.impl.FireboltAdapter object at 0x7ff16a83e760>\nrelations = [<FireboltRelation expected>, <FireboltRelation actual>]\ncompare_snapshot_cols = False\n\n    def check_relations_equal_with_relations(\n        adapter: Adapter, relations: List, compare_snapshot_cols=False\n    ):\n        with get_connection(adapter):\n            basis, compares = relations[0], relations[1:]\n            # Skip columns starting with \"dbt_\" because we don't want to\n            # compare those, since they are time sensitive\n            # (unless comparing \"dbt_\" snapshot columns is explicitly enabled)\n            column_names = [\n                c.name\n                for c in adapter.get_columns_in_relation(basis)  # type: ignore\n                if not c.name.lower().startswith(\"dbt_\") or compare_snapshot_cols\n            ]\n    \n            for relation in compares:\n                sql = adapter.get_rows_different_sql(basis, relation, column_names=column_names)  # type: ignore\n                _, tbl = adapter.execute(sql, fetch=True)\n                num_rows = len(tbl)\n                assert (\n                    num_rows == 1\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of rows ({num_rows})\"\n                num_cols = len(tbl[0])\n                assert (\n                    num_cols == 2\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of cols ({num_cols})\"\n                row_count_difference = tbl[0][0]\n                assert (\n                    row_count_difference == 0\n                ), f\"Got {row_count_difference} difference in row count betwen {basis} and {relation}\"\n                rows_mismatched = tbl[0][1]\n>               assert (\n                    rows_mismatched == 0\n                ), f\"Got {rows_mismatched} different rows between {basis} and {relation}\"\nE               AssertionError: Got 6 different rows between expected and actual\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:459: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"shared_data_dir","time":{"start":1721922502544,"stop":1721922502544,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmpdir_factory","time":{"start":1721922502544,"stop":1721922502544,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data_dir","time":{"start":1721923421514,"stop":1721923421514,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clean_up_logging","time":{"start":1721923656590,"stop":1721923656590,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_root","time":{"start":1721923656590,"stop":1721923656591,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_root","time":{"start":1721923656591,"stop":1721923656592,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_target","time":{"start":1721923656592,"stop":1721923656592,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"prefix","time":{"start":1721923656592,"stop":1721923656592,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml","time":{"start":1721923656592,"stop":1721923656593,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_config_update","time":{"start":1721923656592,"stop":1721923656592,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_data","time":{"start":1721923656592,"stop":1721923656592,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1721923656592,"stop":1721923656592,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_project_yml","time":{"start":1721923656593,"stop":1721923656594,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1721923656593,"stop":1721923656593,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter","time":{"start":1721923656594,"stop":1721923657043,"duration":449},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies_yml","time":{"start":1721923656594,"stop":1721923656594,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors_yml","time":{"start":1721923656594,"stop":1721923656594,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors","time":{"start":1721923656594,"stop":1721923656594,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages_yml","time":{"start":1721923656594,"stop":1721923656594,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages","time":{"start":1721923656594,"stop":1721923656594,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies","time":{"start":1721923656594,"stop":1721923656594,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"models","time":{"start":1721923657043,"stop":1721923657043,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"snapshots","time":{"start":1721923657043,"stop":1721923657043,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"macros","time":{"start":1721923657043,"stop":1721923657043,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"analyses","time":{"start":1721923657044,"stop":1721923657044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tests","time":{"start":1721923657044,"stop":1721923657044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1721923657044,"stop":1721923657044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_files","time":{"start":1721923657044,"stop":1721923657045,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"properties","time":{"start":1721923657044,"stop":1721923657044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir","time":{"start":1721923657045,"stop":1721923657045,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project","time":{"start":1721923657045,"stop":1721923657518,"duration":473},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_config","time":{"start":1721923657045,"stop":1721923657045,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: Got 6 different rows between expected and actual","statusTrace":"self = <test_utils.TestArrayConcat object at 0x7ff16c6d9460>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7ff1693f9640>\n\n    def test_expected_actual(self, project):\n        run_dbt([\"build\"])\n    \n        # check contents equal\n>       check_relations_equal(project.adapter, [\"expected\", \"actual\"])\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/utils/base_array_utils.py:15: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:407: in check_relations_equal\n    return check_relations_equal_with_relations(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nadapter = <dbt.adapters.firebolt.impl.FireboltAdapter object at 0x7ff16a83e760>\nrelations = [<FireboltRelation expected>, <FireboltRelation actual>]\ncompare_snapshot_cols = False\n\n    def check_relations_equal_with_relations(\n        adapter: Adapter, relations: List, compare_snapshot_cols=False\n    ):\n        with get_connection(adapter):\n            basis, compares = relations[0], relations[1:]\n            # Skip columns starting with \"dbt_\" because we don't want to\n            # compare those, since they are time sensitive\n            # (unless comparing \"dbt_\" snapshot columns is explicitly enabled)\n            column_names = [\n                c.name\n                for c in adapter.get_columns_in_relation(basis)  # type: ignore\n                if not c.name.lower().startswith(\"dbt_\") or compare_snapshot_cols\n            ]\n    \n            for relation in compares:\n                sql = adapter.get_rows_different_sql(basis, relation, column_names=column_names)  # type: ignore\n                _, tbl = adapter.execute(sql, fetch=True)\n                num_rows = len(tbl)\n                assert (\n                    num_rows == 1\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of rows ({num_rows})\"\n                num_cols = len(tbl[0])\n                assert (\n                    num_cols == 2\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of cols ({num_cols})\"\n                row_count_difference = tbl[0][0]\n                assert (\n                    row_count_difference == 0\n                ), f\"Got {row_count_difference} difference in row count betwen {basis} and {relation}\"\n                rows_mismatched = tbl[0][1]\n>               assert (\n                    rows_mismatched == 0\n                ), f\"Got {rows_mismatched} different rows between {basis} and {relation}\"\nE               AssertionError: Got 6 different rows between expected and actual\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:459: AssertionError","steps":[],"attachments":[{"uid":"807624f2d4a6921e","name":"log","source":"807624f2d4a6921e.txt","type":"text/plain","size":30330},{"uid":"a6bb39ce80d9f5f4","name":"stdout","source":"a6bb39ce80d9f5f4.txt","type":"text/plain","size":997}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"project::0","time":{"start":1721923666580,"stop":1721923674987,"duration":8407},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir::0","time":{"start":1721923674987,"stop":1721923674987,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter::0","time":{"start":1721923674989,"stop":1721923674990,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml::0","time":{"start":1721923674992,"stop":1721923674992,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter.utils"},{"name":"suite","value":"test_utils"},{"name":"subSuite","value":"TestArrayConcat"},{"name":"host","value":"fv-az777-613"},{"name":"thread","value":"2178-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.utils.test_utils"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"620b1f6f8b117199.json","parameterValues":[]}