{"uid":"4c4f52e7f0987b8","name":"test_ephemeral_multi","fullName":"tests.functional.adapter.test_ephemeral.TestEphemeralMultiFirebolt#test_ephemeral_multi","historyId":"9288ac85bad9c6da313e8c30dd9a9167","time":{"start":1753380858566,"stop":1753380860255,"duration":1689},"status":"failed","statusMessage":"AssertionError: assert \"CREATETABLEI...der='Female')\" == \"CREATEDIMENS...der='Female')\"\n  - CREATEDIMENSIONTABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')\n  ?       ---------\n  + CREATETABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')","statusTrace":"self = <test_ephemeral.TestEphemeralMultiFirebolt object at 0x7fb233168400>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7fb2318baf50>\n\n    def test_ephemeral_multi(self, project):\n        run_dbt(['seed'])\n        results = run_dbt(['run'])\n        assert len(results) == 3\n    \n        check_relations_equal(project.adapter, ['seed', 'dependent'])\n        check_relations_equal(project.adapter, ['seed', 'double_dependent'])\n        check_relations_equal(project.adapter, ['seed', 'super_dependent'])\n        assert os.path.exists('./target/run/test/models/double_dependent.sql')\n        with open('./target/run/test/models/double_dependent.sql', 'r') as fp:\n            sql_file = fp.read()\n    \n        sql_file = re.sub(r'\\d+', '', sql_file)\n        expected_sql = (\n            'CREATE DIMENSION TABLE IF NOT EXISTS double_dependent AS ('\n            'with __dbt__cte__base as ('\n            'select * from public.seed'\n            '),  __dbt__cte__base_copy as ('\n            'select * from __dbt__cte__base'\n            ')-- base_copy just pulls from base. Make sure the listed'\n            '-- graph of CTEs all share the same dbt_cte__base cte'\n            \"select * from __dbt__cte__base where gender = 'Male'\"\n            'union all'\n            \"select * from __dbt__cte__base_copy where gender = 'Female'\"\n            ')'\n        )\n        sql_file = ''.join(sql_file.split())\n        expected_sql = ''.join(expected_sql.split())\n>       assert sql_file == expected_sql\nE       assert \"CREATETABLEI...der='Female')\" == \"CREATEDIMENS...der='Female')\"\nE         - CREATEDIMENSIONTABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')\nE         ?       ---------\nE         + CREATETABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')\n\n/home/runner/work/dbt-firebolt/dbt-firebolt/tests/functional/adapter/test_ephemeral.py:84: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"shared_data_dir","time":{"start":1753380777210,"stop":1753380777210,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmpdir_factory","time":{"start":1753380777211,"stop":1753380777211,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"environment","time":{"start":1753380858466,"stop":1753380858466,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"initialization","time":{"start":1753380858466,"stop":1753380858467,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data_dir","time":{"start":1753380858466,"stop":1753380858466,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_root","time":{"start":1753380858467,"stop":1753380858468,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clean_up_logging","time":{"start":1753380858467,"stop":1753380858467,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_root","time":{"start":1753380858467,"stop":1753380858467,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1753380858468,"stop":1753380858468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_target","time":{"start":1753380858468,"stop":1753380858468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml","time":{"start":1753380858468,"stop":1753380858469,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_data","time":{"start":1753380858468,"stop":1753380858468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_config_update","time":{"start":1753380858468,"stop":1753380858468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"prefix","time":{"start":1753380858468,"stop":1753380858468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir","time":{"start":1753380858469,"stop":1753380858469,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1753380858470,"stop":1753380858470,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_project_yml","time":{"start":1753380858470,"stop":1753380858470,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter","time":{"start":1753380858470,"stop":1753380858504,"duration":34},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_config","time":{"start":1753380858504,"stop":1753380858504,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_setup","time":{"start":1753380858505,"stop":1753380858562,"duration":57},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"models","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"snapshots","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"properties","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors_yml","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"analyses","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"macros","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tests","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1753380858563,"stop":1753380858563,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages","time":{"start":1753380858564,"stop":1753380858564,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages_yml","time":{"start":1753380858564,"stop":1753380858564,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_files","time":{"start":1753380858564,"stop":1753380858565,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies_yml","time":{"start":1753380858564,"stop":1753380858564,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project","time":{"start":1753380858565,"stop":1753380858565,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1753380860745,"stop":1753380860745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: assert \"CREATETABLEI...der='Female')\" == \"CREATEDIMENS...der='Female')\"\n  - CREATEDIMENSIONTABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')\n  ?       ---------\n  + CREATETABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')","statusTrace":"self = <test_ephemeral.TestEphemeralMultiFirebolt object at 0x7fb233168400>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7fb2318baf50>\n\n    def test_ephemeral_multi(self, project):\n        run_dbt(['seed'])\n        results = run_dbt(['run'])\n        assert len(results) == 3\n    \n        check_relations_equal(project.adapter, ['seed', 'dependent'])\n        check_relations_equal(project.adapter, ['seed', 'double_dependent'])\n        check_relations_equal(project.adapter, ['seed', 'super_dependent'])\n        assert os.path.exists('./target/run/test/models/double_dependent.sql')\n        with open('./target/run/test/models/double_dependent.sql', 'r') as fp:\n            sql_file = fp.read()\n    \n        sql_file = re.sub(r'\\d+', '', sql_file)\n        expected_sql = (\n            'CREATE DIMENSION TABLE IF NOT EXISTS double_dependent AS ('\n            'with __dbt__cte__base as ('\n            'select * from public.seed'\n            '),  __dbt__cte__base_copy as ('\n            'select * from __dbt__cte__base'\n            ')-- base_copy just pulls from base. Make sure the listed'\n            '-- graph of CTEs all share the same dbt_cte__base cte'\n            \"select * from __dbt__cte__base where gender = 'Male'\"\n            'union all'\n            \"select * from __dbt__cte__base_copy where gender = 'Female'\"\n            ')'\n        )\n        sql_file = ''.join(sql_file.split())\n        expected_sql = ''.join(expected_sql.split())\n>       assert sql_file == expected_sql\nE       assert \"CREATETABLEI...der='Female')\" == \"CREATEDIMENS...der='Female')\"\nE         - CREATEDIMENSIONTABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')\nE         ?       ---------\nE         + CREATETABLEIFNOTEXISTSdouble_dependentAS(with__dbt__cte__baseas(select*frompublic.seed),__dbt__cte__base_copyas(select*from__dbt__cte__base)--base_copyjustpullsfrombase.Makesurethelisted--graphofCTEsallsharethesamedbt_cte__basecteselect*from__dbt__cte__basewheregender='Male'unionallselect*from__dbt__cte__base_copywheregender='Female')\n\n/home/runner/work/dbt-firebolt/dbt-firebolt/tests/functional/adapter/test_ephemeral.py:84: AssertionError","steps":[],"attachments":[{"uid":"f2d11ac15b8f2b27","name":"log","source":"f2d11ac15b8f2b27.txt","type":"text/plain","size":17192},{"uid":"a88f2225830f54d4","name":"stdout","source":"a88f2225830f54d4.txt","type":"text/plain","size":2053},{"uid":"3eccb8c2106d62db","name":"stderr","source":"3eccb8c2106d62db.txt","type":"text/plain","size":14381}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":3,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"project_setup::0","time":{"start":1753380860262,"stop":1753380860642,"duration":380},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter::0","time":{"start":1753380860642,"stop":1753380860643,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir::0","time":{"start":1753380860643,"stop":1753380860643,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml::0","time":{"start":1753380860644,"stop":1753380860644,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter"},{"name":"suite","value":"test_ephemeral"},{"name":"subSuite","value":"TestEphemeralMultiFirebolt"},{"name":"host","value":"pkrvmpptgkbjq6m"},{"name":"thread","value":"4681-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.test_ephemeral"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"4c4f52e7f0987b8.json","parameterValues":[]}