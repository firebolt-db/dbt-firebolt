{"uid":"fa03288d8815ad7d","name":"test_pre_and_post_model_hooks_model","fullName":"tests.functional.adapter.hooks.test_model_hooks.TestPrePostModelHooksInConfigFirebolt#test_pre_and_post_model_hooks_model","historyId":"3c800d2e04ed4d35ceaebe66c7aafc7e","time":{"start":1721921470877,"stop":1721921470877,"duration":0},"status":"broken","statusMessage":"dbt.exceptions.DbtProjectError: Runtime Error\n  Do not specify both 'config' in profiles.yml and 'flags' in dbt_project.yml. Using 'config' in profiles.yml is deprecated.","statusTrace":"unique_schema = 'public'\nproject_root = local('/tmp/pytest-of-runner/pytest-0/project37')\nprofiles_root = local('/tmp/pytest-of-runner/pytest-0/profile37')\nprofiles_yml = {'config': {'send_anonymous_usage_stats': False}, 'test': {'outputs': {'default': {'account_name': 'automation', 'api_...'client_id': 'mrWFcIhFtkxKd5fLm40MrRp7rDuZBBZ0', 'client_secret': SecretStr('**********'), ...}}, 'target': 'default'}}\ndbt_project_yml = {'flags': {'send_anonymous_usage_stats': False}, 'macro-paths': ['macros'], 'name': 'test', 'profile': 'test'}\nclean_up_logging = None\n\n    @pytest.fixture(scope=\"class\")\n    def adapter(\n        unique_schema, project_root, profiles_root, profiles_yml, dbt_project_yml, clean_up_logging\n    ):\n        # The profiles.yml and dbt_project.yml should already be written out\n        args = Namespace(\n            profiles_dir=str(profiles_root),\n            project_dir=str(project_root),\n            target=None,\n            profile=None,\n            threads=None,\n        )\n>       flags.set_from_args(args, {})\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/fixtures/project.py:278: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/flags.py:55: in set_from_args\n    project_flags = read_project_flags(project_dir, profiles_dir)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/config/project.py:831: in read_project_flags\n    raise exc\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nproject_dir = '/tmp/pytest-of-runner/pytest-0/project37'\nprofiles_dir = '/tmp/pytest-of-runner/pytest-0/profile37'\n\n    def read_project_flags(project_dir: str, profiles_dir: str) -> ProjectFlags:\n        try:\n            project_flags: Dict[str, Any] = {}\n            # Read project_flags from dbt_project.yml first\n            # Flags are instantiated before the project, so we don't\n            # want to throw an error for non-existence of dbt_project.yml here\n            # because it breaks things.\n            project_root = os.path.normpath(project_dir)\n            project_yaml_filepath = os.path.join(project_root, DBT_PROJECT_FILE_NAME)\n            if path_exists(project_yaml_filepath):\n                try:\n                    project_dict = load_raw_project(project_root)\n                    if \"flags\" in project_dict:\n                        project_flags = project_dict.pop(\"flags\")\n                except Exception:\n                    # This is probably a yaml load error.The error will be reported\n                    # later, when the project loads.\n                    pass\n    \n            from dbt.config.profile import read_profile\n    \n            profile = read_profile(profiles_dir)\n            profile_project_flags: Optional[Dict[str, Any]] = {}\n            if profile:\n                profile_project_flags = coerce_dict_str(profile.get(\"config\", {}))\n    \n            if project_flags and profile_project_flags:\n>               raise DbtProjectError(\n                    f\"Do not specify both 'config' in profiles.yml and 'flags' in {DBT_PROJECT_FILE_NAME}. \"\n                    \"Using 'config' in profiles.yml is deprecated.\"\n                )\nE               dbt.exceptions.DbtProjectError: Runtime Error\nE                 Do not specify both 'config' in profiles.yml and 'flags' in dbt_project.yml. Using 'config' in profiles.yml is deprecated.\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/config/project.py:815: DbtProjectError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"shared_data_dir","time":{"start":1721921469072,"stop":1721921469072,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmpdir_factory","time":{"start":1721921469072,"stop":1721921469072,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1721921470626,"stop":1721921470626,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data_dir","time":{"start":1721921470626,"stop":1721921470627,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clean_up_logging","time":{"start":1721921470878,"stop":1721921470878,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_root","time":{"start":1721921470878,"stop":1721921470879,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_root","time":{"start":1721921470878,"stop":1721921470878,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_data","time":{"start":1721921470879,"stop":1721921470879,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_target","time":{"start":1721921470879,"stop":1721921470879,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_config_update","time":{"start":1721921470879,"stop":1721921470879,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml","time":{"start":1721921470879,"stop":1721921470880,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1721921470880,"stop":1721921470880,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies","time":{"start":1721921470881,"stop":1721921470881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages_yml","time":{"start":1721921470881,"stop":1721921470881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_project_yml","time":{"start":1721921470881,"stop":1721921470881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors_yml","time":{"start":1721921470881,"stop":1721921470882,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies_yml","time":{"start":1721921470881,"stop":1721921470881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors","time":{"start":1721921470881,"stop":1721921470881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages","time":{"start":1721921470881,"stop":1721921470881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter","time":{"start":1721921470882,"stop":1721921470882,"duration":0},"status":"broken","statusMessage":"dbt.exceptions.DbtProjectError: Runtime Error\n  Do not specify both 'config' in profiles.yml and 'flags' in dbt_project.yml. Using 'config' in profiles.yml is deprecated.\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/_pytest/fixtures.py\", line 1123, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/_pytest/fixtures.py\", line 895, in call_fixture_func\n    fixture_result = next(generator)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/fixtures/project.py\", line 278, in adapter\n    flags.set_from_args(args, {})\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/flags.py\", line 55, in set_from_args\n    project_flags = read_project_flags(project_dir, profiles_dir)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/config/project.py\", line 831, in read_project_flags\n    raise exc\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/config/project.py\", line 815, in read_project_flags\n    raise DbtProjectError(\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"project_config_update","time":{"start":1721921471049,"stop":1721921471049,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1721921471080,"stop":1721921471080,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"prefix","time":{"start":1721921471080,"stop":1721921471080,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"dbt.exceptions.DbtProjectError: Runtime Error\n  Do not specify both 'config' in profiles.yml and 'flags' in dbt_project.yml. Using 'config' in profiles.yml is deprecated.","statusTrace":"unique_schema = 'public'\nproject_root = local('/tmp/pytest-of-runner/pytest-0/project37')\nprofiles_root = local('/tmp/pytest-of-runner/pytest-0/profile37')\nprofiles_yml = {'config': {'send_anonymous_usage_stats': False}, 'test': {'outputs': {'default': {'account_name': 'automation', 'api_...'client_id': 'mrWFcIhFtkxKd5fLm40MrRp7rDuZBBZ0', 'client_secret': SecretStr('**********'), ...}}, 'target': 'default'}}\ndbt_project_yml = {'flags': {'send_anonymous_usage_stats': False}, 'macro-paths': ['macros'], 'name': 'test', 'profile': 'test'}\nclean_up_logging = None\n\n    @pytest.fixture(scope=\"class\")\n    def adapter(\n        unique_schema, project_root, profiles_root, profiles_yml, dbt_project_yml, clean_up_logging\n    ):\n        # The profiles.yml and dbt_project.yml should already be written out\n        args = Namespace(\n            profiles_dir=str(profiles_root),\n            project_dir=str(project_root),\n            target=None,\n            profile=None,\n            threads=None,\n        )\n>       flags.set_from_args(args, {})\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/fixtures/project.py:278: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/flags.py:55: in set_from_args\n    project_flags = read_project_flags(project_dir, profiles_dir)\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/config/project.py:831: in read_project_flags\n    raise exc\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nproject_dir = '/tmp/pytest-of-runner/pytest-0/project37'\nprofiles_dir = '/tmp/pytest-of-runner/pytest-0/profile37'\n\n    def read_project_flags(project_dir: str, profiles_dir: str) -> ProjectFlags:\n        try:\n            project_flags: Dict[str, Any] = {}\n            # Read project_flags from dbt_project.yml first\n            # Flags are instantiated before the project, so we don't\n            # want to throw an error for non-existence of dbt_project.yml here\n            # because it breaks things.\n            project_root = os.path.normpath(project_dir)\n            project_yaml_filepath = os.path.join(project_root, DBT_PROJECT_FILE_NAME)\n            if path_exists(project_yaml_filepath):\n                try:\n                    project_dict = load_raw_project(project_root)\n                    if \"flags\" in project_dict:\n                        project_flags = project_dict.pop(\"flags\")\n                except Exception:\n                    # This is probably a yaml load error.The error will be reported\n                    # later, when the project loads.\n                    pass\n    \n            from dbt.config.profile import read_profile\n    \n            profile = read_profile(profiles_dir)\n            profile_project_flags: Optional[Dict[str, Any]] = {}\n            if profile:\n                profile_project_flags = coerce_dict_str(profile.get(\"config\", {}))\n    \n            if project_flags and profile_project_flags:\n>               raise DbtProjectError(\n                    f\"Do not specify both 'config' in profiles.yml and 'flags' in {DBT_PROJECT_FILE_NAME}. \"\n                    \"Using 'config' in profiles.yml is deprecated.\"\n                )\nE               dbt.exceptions.DbtProjectError: Runtime Error\nE                 Do not specify both 'config' in profiles.yml and 'flags' in dbt_project.yml. Using 'config' in profiles.yml is deprecated.\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/config/project.py:815: DbtProjectError","steps":[],"attachments":[{"uid":"23ee603b0ccf76f1","name":"stdout","source":"23ee603b0ccf76f1.txt","type":"text/plain","size":65}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"profiles_yml::0","time":{"start":1721921470952,"stop":1721921470952,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter.hooks"},{"name":"suite","value":"test_model_hooks"},{"name":"subSuite","value":"TestPrePostModelHooksInConfigFirebolt"},{"name":"host","value":"fv-az1780-7"},{"name":"thread","value":"2204-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.hooks.test_model_hooks"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":0,"unknown":0,"total":2},"items":[{"uid":"a16bdbadcc8f9285","reportUrl":"https://firebolt-db.github.io/dbt-firebolt/_98d7f1883231fb96bf7c5cccf7deb8ab67e7a87e_integration-v2/16//#testresult/a16bdbadcc8f9285","status":"broken","statusDetails":"dbt.exceptions.DbtProjectError: Runtime Error\n  Do not specify both 'config' in profiles.yml and 'flags' in dbt_project.yml. Using 'config' in profiles.yml is deprecated.","time":{"start":1721722280808,"stop":1721722280808,"duration":0}}]},"tags":[]},"source":"fa03288d8815ad7d.json","parameterValues":[]}