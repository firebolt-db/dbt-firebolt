{"uid":"da8ac975c264997a","name":"test_unit_test_data_type","fullName":"tests.functional.adapter.unit_testing.test_unit_testing.TestFireboltUnitTestingTypes#test_unit_test_data_type","historyId":"befa0c738caa43171237bee58e1dceea","time":{"start":1753719210806,"stop":1753719211556,"duration":750},"status":"failed","statusMessage":"AssertionError: unit test failed when testing model with 1","statusTrace":"self = <test_unit_testing.TestFireboltUnitTestingTypes object at 0x7f3a15120190>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7f3a11d3a680>\ndata_types = [['1', '1'], [\"'1'\", '1'], ['true', 'true'], [\"DATE '2020-01-02'\", '2020-01-02'], [\"TIMESTAMP '2013-11-03 00:00:00'\", '2013-11-03 00:00:00'], [\"TIMESTAMPTZ '2013-11-03 00:00:00-0'\", '2013-11-03 00:00:00-0'], ...]\n\n    def test_unit_test_data_type(self, project, data_types):\n        for sql_value, yaml_value in data_types:\n            # Write parametrized type value to sql files\n            write_file(\n                my_upstream_model_sql.format(sql_value=sql_value),\n                \"models\",\n                \"my_upstream_model.sql\",\n            )\n    \n            # Write parametrized type value to unit test yaml definition\n            write_file(\n                test_my_model_yml.format(yaml_value=yaml_value),\n                \"models\",\n                \"schema.yml\",\n            )\n    \n            results = run_dbt([\"run\", \"--select\", \"my_upstream_model\"])\n            assert len(results) == 1\n    \n            try:\n>               run_dbt([\"test\", \"--select\", \"my_model\"])\n\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/dbt/tests/adapter/unit_testing/test_types.py:78: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nargs = ['test', '--select', 'my_model', '--project-dir', '/tmp/pytest-of-runner/pytest-0/project62', '--profiles-dir', ...]\nexpect_pass = True, callbacks = None\n\n    def run_dbt(\n        args: Optional[List[str]] = None,\n        expect_pass: bool = True,\n        callbacks: Optional[List[Callable[[EventMsg], None]]] = None,\n    ):\n        # reset global vars\n        reset_metadata_vars()\n    \n        if args is None:\n            args = [\"run\"]\n    \n        print(\"\\n\\nInvoking dbt with {}\".format(args))\n        from dbt.flags import get_flags\n    \n        flags = get_flags()\n        project_dir = getattr(flags, \"PROJECT_DIR\", None)\n        profiles_dir = getattr(flags, \"PROFILES_DIR\", None)\n        if project_dir and \"--project-dir\" not in args:\n            args.extend([\"--project-dir\", project_dir])\n        if profiles_dir and \"--profiles-dir\" not in args:\n            args.extend([\"--profiles-dir\", profiles_dir])\n        dbt = dbtRunner(callbacks=callbacks)\n    \n        res = dbt.invoke(args)\n    \n        # the exception is immediately raised to be caught in tests\n        # using a pattern like `with pytest.raises(SomeException):`\n        if res.exception is not None:\n            raise res.exception\n    \n        if expect_pass is not None:\n>           assert res.success == expect_pass, \"dbt exit state did not match expected\"\nE           AssertionError: dbt exit state did not match expected\n\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/dbt/tests/util.py:107: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_unit_testing.TestFireboltUnitTestingTypes object at 0x7f3a15120190>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7f3a11d3a680>\ndata_types = [['1', '1'], [\"'1'\", '1'], ['true', 'true'], [\"DATE '2020-01-02'\", '2020-01-02'], [\"TIMESTAMP '2013-11-03 00:00:00'\", '2013-11-03 00:00:00'], [\"TIMESTAMPTZ '2013-11-03 00:00:00-0'\", '2013-11-03 00:00:00-0'], ...]\n\n    def test_unit_test_data_type(self, project, data_types):\n        for sql_value, yaml_value in data_types:\n            # Write parametrized type value to sql files\n            write_file(\n                my_upstream_model_sql.format(sql_value=sql_value),\n                \"models\",\n                \"my_upstream_model.sql\",\n            )\n    \n            # Write parametrized type value to unit test yaml definition\n            write_file(\n                test_my_model_yml.format(yaml_value=yaml_value),\n                \"models\",\n                \"schema.yml\",\n            )\n    \n            results = run_dbt([\"run\", \"--select\", \"my_upstream_model\"])\n            assert len(results) == 1\n    \n            try:\n                run_dbt([\"test\", \"--select\", \"my_model\"])\n            except Exception:\n>               raise AssertionError(f\"unit test failed when testing model with {sql_value}\")\nE               AssertionError: unit test failed when testing model with 1\n\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/dbt/tests/adapter/unit_testing/test_types.py:80: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"tmpdir_factory","time":{"start":1753719048421,"stop":1753719048421,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"shared_data_dir","time":{"start":1753719048421,"stop":1753719048421,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data_dir","time":{"start":1753719207314,"stop":1753719207314,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clean_up_logging","time":{"start":1753719210705,"stop":1753719210705,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"initialization","time":{"start":1753719210705,"stop":1753719210705,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"environment","time":{"start":1753719210705,"stop":1753719210705,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_root","time":{"start":1753719210706,"stop":1753719210706,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_root","time":{"start":1753719210706,"stop":1753719210707,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml","time":{"start":1753719210707,"stop":1753719210708,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_data","time":{"start":1753719210707,"stop":1753719210707,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_target","time":{"start":1753719210707,"stop":1753719210707,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"prefix","time":{"start":1753719210707,"stop":1753719210707,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_config_update","time":{"start":1753719210707,"stop":1753719210707,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1753719210707,"stop":1753719210707,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir","time":{"start":1753719210708,"stop":1753719210708,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1753719210709,"stop":1753719210709,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_project_yml","time":{"start":1753719210709,"stop":1753719210710,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"is_firebolt_core","time":{"start":1753719210709,"stop":1753719210709,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter","time":{"start":1753719210710,"stop":1753719210745,"duration":35},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_setup","time":{"start":1753719210745,"stop":1753719210803,"duration":58},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_config","time":{"start":1753719210745,"stop":1753719210745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tests","time":{"start":1753719210803,"stop":1753719210804,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"models","time":{"start":1753719210803,"stop":1753719210803,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"snapshots","time":{"start":1753719210803,"stop":1753719210803,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"properties","time":{"start":1753719210803,"stop":1753719210803,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1753719210803,"stop":1753719210803,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"macros","time":{"start":1753719210803,"stop":1753719210803,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_files","time":{"start":1753719210804,"stop":1753719210805,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors_yml","time":{"start":1753719210804,"stop":1753719210804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"analyses","time":{"start":1753719210804,"stop":1753719210804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages_yml","time":{"start":1753719210804,"stop":1753719210804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors","time":{"start":1753719210804,"stop":1753719210804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies_yml","time":{"start":1753719210804,"stop":1753719210804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages","time":{"start":1753719210804,"stop":1753719210804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies","time":{"start":1753719210804,"stop":1753719210804,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project","time":{"start":1753719210805,"stop":1753719210805,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"data_types","time":{"start":1753719210805,"stop":1753719210805,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: unit test failed when testing model with 1","statusTrace":"self = <test_unit_testing.TestFireboltUnitTestingTypes object at 0x7f3a15120190>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7f3a11d3a680>\ndata_types = [['1', '1'], [\"'1'\", '1'], ['true', 'true'], [\"DATE '2020-01-02'\", '2020-01-02'], [\"TIMESTAMP '2013-11-03 00:00:00'\", '2013-11-03 00:00:00'], [\"TIMESTAMPTZ '2013-11-03 00:00:00-0'\", '2013-11-03 00:00:00-0'], ...]\n\n    def test_unit_test_data_type(self, project, data_types):\n        for sql_value, yaml_value in data_types:\n            # Write parametrized type value to sql files\n            write_file(\n                my_upstream_model_sql.format(sql_value=sql_value),\n                \"models\",\n                \"my_upstream_model.sql\",\n            )\n    \n            # Write parametrized type value to unit test yaml definition\n            write_file(\n                test_my_model_yml.format(yaml_value=yaml_value),\n                \"models\",\n                \"schema.yml\",\n            )\n    \n            results = run_dbt([\"run\", \"--select\", \"my_upstream_model\"])\n            assert len(results) == 1\n    \n            try:\n>               run_dbt([\"test\", \"--select\", \"my_model\"])\n\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/dbt/tests/adapter/unit_testing/test_types.py:78: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nargs = ['test', '--select', 'my_model', '--project-dir', '/tmp/pytest-of-runner/pytest-0/project62', '--profiles-dir', ...]\nexpect_pass = True, callbacks = None\n\n    def run_dbt(\n        args: Optional[List[str]] = None,\n        expect_pass: bool = True,\n        callbacks: Optional[List[Callable[[EventMsg], None]]] = None,\n    ):\n        # reset global vars\n        reset_metadata_vars()\n    \n        if args is None:\n            args = [\"run\"]\n    \n        print(\"\\n\\nInvoking dbt with {}\".format(args))\n        from dbt.flags import get_flags\n    \n        flags = get_flags()\n        project_dir = getattr(flags, \"PROJECT_DIR\", None)\n        profiles_dir = getattr(flags, \"PROFILES_DIR\", None)\n        if project_dir and \"--project-dir\" not in args:\n            args.extend([\"--project-dir\", project_dir])\n        if profiles_dir and \"--profiles-dir\" not in args:\n            args.extend([\"--profiles-dir\", profiles_dir])\n        dbt = dbtRunner(callbacks=callbacks)\n    \n        res = dbt.invoke(args)\n    \n        # the exception is immediately raised to be caught in tests\n        # using a pattern like `with pytest.raises(SomeException):`\n        if res.exception is not None:\n            raise res.exception\n    \n        if expect_pass is not None:\n>           assert res.success == expect_pass, \"dbt exit state did not match expected\"\nE           AssertionError: dbt exit state did not match expected\n\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/dbt/tests/util.py:107: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_unit_testing.TestFireboltUnitTestingTypes object at 0x7f3a15120190>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7f3a11d3a680>\ndata_types = [['1', '1'], [\"'1'\", '1'], ['true', 'true'], [\"DATE '2020-01-02'\", '2020-01-02'], [\"TIMESTAMP '2013-11-03 00:00:00'\", '2013-11-03 00:00:00'], [\"TIMESTAMPTZ '2013-11-03 00:00:00-0'\", '2013-11-03 00:00:00-0'], ...]\n\n    def test_unit_test_data_type(self, project, data_types):\n        for sql_value, yaml_value in data_types:\n            # Write parametrized type value to sql files\n            write_file(\n                my_upstream_model_sql.format(sql_value=sql_value),\n                \"models\",\n                \"my_upstream_model.sql\",\n            )\n    \n            # Write parametrized type value to unit test yaml definition\n            write_file(\n                test_my_model_yml.format(yaml_value=yaml_value),\n                \"models\",\n                \"schema.yml\",\n            )\n    \n            results = run_dbt([\"run\", \"--select\", \"my_upstream_model\"])\n            assert len(results) == 1\n    \n            try:\n                run_dbt([\"test\", \"--select\", \"my_model\"])\n            except Exception:\n>               raise AssertionError(f\"unit test failed when testing model with {sql_value}\")\nE               AssertionError: unit test failed when testing model with 1\n\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/dbt/tests/adapter/unit_testing/test_types.py:80: AssertionError","steps":[],"attachments":[{"uid":"a8433c389692f05f","name":"log","source":"a8433c389692f05f.txt","type":"text/plain","size":12252},{"uid":"f491b2c218dad047","name":"stdout","source":"f491b2c218dad047.txt","type":"text/plain","size":3037},{"uid":"1c3de950fa18df0e","name":"stderr","source":"1c3de950fa18df0e.txt","type":"text/plain","size":10257}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":3,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"project_setup::0","time":{"start":1753719211571,"stop":1753719211918,"duration":347},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter::0","time":{"start":1753719211919,"stop":1753719211919,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml::0","time":{"start":1753719211920,"stop":1753719211920,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir::0","time":{"start":1753719211920,"stop":1753719211920,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter.unit_testing"},{"name":"suite","value":"test_unit_testing"},{"name":"subSuite","value":"TestFireboltUnitTestingTypes"},{"name":"host","value":"pkrvmpptgkbjq6m"},{"name":"thread","value":"4371-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.unit_testing.test_unit_testing"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"da8ac975c264997a.json","parameterValues":[]}