{"uid":"af7f3e1f213b5ff6","name":"test_tests_run_successfully_and_are_stored_as_expected","fullName":"tests.functional.adapter.test_store_test_failures.TestStoreTestFailuresAsProjectLevelOff#test_tests_run_successfully_and_are_stored_as_expected","historyId":"88cd3e6a9727ae3d976cdca9bda94dbe","time":{"start":1724770435843,"stop":1724770435843,"duration":0},"status":"failed","statusMessage":"AssertionError: dbt exit state did not match expected","statusTrace":"self = <test_store_test_failures.TestStoreTestFailuresAsProjectLevelOff object at 0x7fc1163b3a00>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7fc107bcb370>\n\n    @pytest.fixture(scope=\"class\", autouse=True)\n    def setup_class(self, project):\n        # the seed doesn't get touched, load it once\n>       run_dbt([\"seed\"])\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/store_test_failures_tests/basic.py:25: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nargs = ['seed', '--project-dir', '/tmp/pytest-of-runner/pytest-0/project35', '--profiles-dir', '/tmp/pytest-of-runner/pytest-0/profile35']\nexpect_pass = True\n\n    def run_dbt(\n        args: Optional[List[str]] = None,\n        expect_pass: bool = True,\n    ):\n        # Ignore logbook warnings\n        warnings.filterwarnings(\"ignore\", category=DeprecationWarning, module=\"logbook\")\n    \n        # reset global vars\n        reset_metadata_vars()\n    \n        # The logger will complain about already being initialized if\n        # we don't do this.\n        log_manager.reset_handlers()\n        if args is None:\n            args = [\"run\"]\n    \n        print(\"\\n\\nInvoking dbt with {}\".format(args))\n        from dbt.flags import get_flags\n    \n        flags = get_flags()\n        project_dir = getattr(flags, \"PROJECT_DIR\", None)\n        profiles_dir = getattr(flags, \"PROFILES_DIR\", None)\n        if project_dir and \"--project-dir\" not in args:\n            args.extend([\"--project-dir\", project_dir])\n        if profiles_dir and \"--profiles-dir\" not in args:\n            args.extend([\"--profiles-dir\", profiles_dir])\n    \n        dbt = dbtRunner()\n        res = dbt.invoke(args)\n    \n        # the exception is immediately raised to be caught in tests\n        # using a pattern like `with pytest.raises(SomeException):`\n        if res.exception is not None:\n            raise res.exception\n    \n        if expect_pass is not None:\n>           assert res.success == expect_pass, \"dbt exit state did not match expected\"\nE           AssertionError: dbt exit state did not match expected\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:108: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"tmpdir_factory","time":{"start":1724770020791,"stop":1724770020791,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"shared_data_dir","time":{"start":1724770020791,"stop":1724770020791,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"test_data_dir","time":{"start":1724770429708,"stop":1724770429708,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"clean_up_logging","time":{"start":1724770435843,"stop":1724770435844,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"profiles_root","time":{"start":1724770435844,"stop":1724770435845,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"project_root","time":{"start":1724770435844,"stop":1724770435844,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"dbt_profile_target","time":{"start":1724770435845,"stop":1724770435845,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"dbt_profile_data","time":{"start":1724770435845,"stop":1724770435845,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"prefix","time":{"start":1724770435845,"stop":1724770435845,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"profiles_config_update","time":{"start":1724770435845,"stop":1724770435845,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"unique_schema","time":{"start":1724770435845,"stop":1724770435845,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"profiles_yml","time":{"start":1724770435845,"stop":1724770435846,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"project_config_update","time":{"start":1724770435846,"stop":1724770435846,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"selectors","time":{"start":1724770435847,"stop":1724770435847,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"dependencies_yml","time":{"start":1724770435847,"stop":1724770435847,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"dbt_project_yml","time":{"start":1724770435847,"stop":1724770435847,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"packages","time":{"start":1724770435847,"stop":1724770435847,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"dependencies","time":{"start":1724770435847,"stop":1724770435847,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"packages_yml","time":{"start":1724770435847,"stop":1724770435847,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"selectors_yml","time":{"start":1724770435848,"stop":1724770435848,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"adapter","time":{"start":1724770435848,"stop":1724770436311,"duration":463},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"models","time":{"start":1724770436311,"stop":1724770436311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"macros","time":{"start":1724770436311,"stop":1724770436311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"snapshots","time":{"start":1724770436311,"stop":1724770436311,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"seeds","time":{"start":1724770436312,"stop":1724770436312,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"project_files","time":{"start":1724770436312,"stop":1724770436313,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"properties","time":{"start":1724770436312,"stop":1724770436312,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"analyses","time":{"start":1724770436312,"stop":1724770436312,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"tests","time":{"start":1724770436312,"stop":1724770436312,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"test_config","time":{"start":1724770436313,"stop":1724770436313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"project","time":{"start":1724770436313,"stop":1724770436563,"duration":250},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"logs_dir","time":{"start":1724770436313,"stop":1724770436313,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"setup_class","time":{"start":1724770436564,"stop":1724770439183,"duration":2619},"status":"failed","statusMessage":"AssertionError: dbt exit state did not match expected\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/_pytest/fixtures.py\", line 1123, in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/_pytest/fixtures.py\", line 895, in call_fixture_func\n    fixture_result = next(generator)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/store_test_failures_tests/basic.py\", line 25, in setup_class\n    run_dbt([\"seed\"])\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py\", line 108, in run_dbt\n    assert res.success == expect_pass, \"dbt exit state did not match expected\"\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"hasContent":true,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"project_config_update","time":{"start":1724770448158,"stop":1724770448158,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"tests","time":{"start":1724770448626,"stop":1724770448626,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"seeds","time":{"start":1724770466426,"stop":1724770466426,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0}],"testStage":{"status":"failed","statusMessage":"AssertionError: dbt exit state did not match expected","statusTrace":"self = <test_store_test_failures.TestStoreTestFailuresAsProjectLevelOff object at 0x7fc1163b3a00>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7fc107bcb370>\n\n    @pytest.fixture(scope=\"class\", autouse=True)\n    def setup_class(self, project):\n        # the seed doesn't get touched, load it once\n>       run_dbt([\"seed\"])\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/store_test_failures_tests/basic.py:25: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nargs = ['seed', '--project-dir', '/tmp/pytest-of-runner/pytest-0/project35', '--profiles-dir', '/tmp/pytest-of-runner/pytest-0/profile35']\nexpect_pass = True\n\n    def run_dbt(\n        args: Optional[List[str]] = None,\n        expect_pass: bool = True,\n    ):\n        # Ignore logbook warnings\n        warnings.filterwarnings(\"ignore\", category=DeprecationWarning, module=\"logbook\")\n    \n        # reset global vars\n        reset_metadata_vars()\n    \n        # The logger will complain about already being initialized if\n        # we don't do this.\n        log_manager.reset_handlers()\n        if args is None:\n            args = [\"run\"]\n    \n        print(\"\\n\\nInvoking dbt with {}\".format(args))\n        from dbt.flags import get_flags\n    \n        flags = get_flags()\n        project_dir = getattr(flags, \"PROJECT_DIR\", None)\n        profiles_dir = getattr(flags, \"PROFILES_DIR\", None)\n        if project_dir and \"--project-dir\" not in args:\n            args.extend([\"--project-dir\", project_dir])\n        if profiles_dir and \"--profiles-dir\" not in args:\n            args.extend([\"--profiles-dir\", profiles_dir])\n    \n        dbt = dbtRunner()\n        res = dbt.invoke(args)\n    \n        # the exception is immediately raised to be caught in tests\n        # using a pattern like `with pytest.raises(SomeException):`\n        if res.exception is not None:\n            raise res.exception\n    \n        if expect_pass is not None:\n>           assert res.success == expect_pass, \"dbt exit state did not match expected\"\nE           AssertionError: dbt exit state did not match expected\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:108: AssertionError","steps":[],"attachments":[{"uid":"e0a33c9026a484f2","name":"log","source":"e0a33c9026a484f2.txt","type":"text/plain","size":13545},{"uid":"2a87b8d9ad04f956","name":"stdout","source":"2a87b8d9ad04f956.txt","type":"text/plain","size":1257}],"parameters":[],"shouldDisplayMessage":true,"hasContent":true,"attachmentStep":false,"stepsCount":0,"attachmentsCount":2},"afterStages":[{"name":"project::0","time":{"start":1724770439196,"stop":1724770441882,"duration":2686},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"logs_dir::0","time":{"start":1724770441883,"stop":1724770441883,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"adapter::0","time":{"start":1724770441884,"stop":1724770441885,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0},{"name":"profiles_yml::0","time":{"start":1724770441887,"stop":1724770441887,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0,"attachmentsCount":0}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter"},{"name":"suite","value":"test_store_test_failures"},{"name":"subSuite","value":"TestStoreTestFailuresAsProjectLevelOff"},{"name":"host","value":"fv-az530-511"},{"name":"thread","value":"2403-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.test_store_test_failures"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"af7f3e1f213b5ff6.json","parameterValues":[]}