{"uid":"a5a7775fcff9e1f1","name":"test_base","fullName":"tests.functional.adapter.test_basic.TestSimpleMaterializationsFirebolt#test_base","historyId":"aa0e864726779625e566bc98b9079041","time":{"start":1722440227697,"stop":1722440249124,"duration":21427},"status":"failed","statusMessage":"AssertionError: Got an unexpected relation type of external for relation base, expected table","statusTrace":"self = <test_basic.TestSimpleMaterializationsFirebolt object at 0x7feee06c8fa0>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7feedfccf370>\n\n    def test_base(self, project):\n    \n        # seed command\n        results = run_dbt([\"seed\"])\n        # seed result length\n        assert len(results) == 1\n    \n        # run command\n        results = run_dbt()\n        # run result length\n        assert len(results) == 3\n    \n        # names exist in result nodes\n        check_result_nodes_by_name(results, [\"view_model\", \"table_model\", \"swappable\"])\n    \n        # check relation types\n        expected = {\n            \"base\": \"table\",\n            \"view_model\": \"view\",\n            \"table_model\": \"table\",\n            \"swappable\": \"table\",\n        }\n>       check_relation_types(project.adapter, expected)\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/basic/test_base.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nadapter = <dbt.adapters.firebolt.impl.FireboltAdapter object at 0x7feedf374e50>\nrelation_to_type = {'base': 'table', 'swappable': 'table', 'table_model': 'table', 'view_model': 'view'}\n\n    def check_relation_types(adapter, relation_to_type):\n        \"\"\"\n        Relation name to table/view\n        {\n            \"base\": \"table\",\n            \"other\": \"view\",\n        }\n        \"\"\"\n    \n        expected_relation_values = {}\n        found_relations = []\n        schemas = set()\n    \n        for key, value in relation_to_type.items():\n            relation = relation_from_name(adapter, key)\n            expected_relation_values[relation] = value\n            schemas.add(relation.without_identifier())\n    \n            with get_connection(adapter):\n                for schema in schemas:\n                    found_relations.extend(adapter.list_relations_without_caching(schema))\n    \n        for key, value in relation_to_type.items():\n            for relation in found_relations:\n                # this might be too broad\n                if relation.identifier == key:\n>                   assert relation.type == value, (\n                        f\"Got an unexpected relation type of {relation.type} \"\n                        f\"for relation {key}, expected {value}\"\n                    )\nE                   AssertionError: Got an unexpected relation type of external for relation base, expected table\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:391: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"clean_up_logging","time":{"start":1722440224466,"stop":1722440224466,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data_dir","time":{"start":1722440224466,"stop":1722440224466,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"shared_data_dir","time":{"start":1722440224466,"stop":1722440224466,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_root","time":{"start":1722440224466,"stop":1722440224468,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmpdir_factory","time":{"start":1722440224466,"stop":1722440224466,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_config_update","time":{"start":1722440224468,"stop":1722440224469,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1722440224468,"stop":1722440224468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"prefix","time":{"start":1722440224468,"stop":1722440224468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_target","time":{"start":1722440224468,"stop":1722440224468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_root","time":{"start":1722440224468,"stop":1722440224468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_data","time":{"start":1722440224469,"stop":1722440224469,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml","time":{"start":1722440224469,"stop":1722440224470,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1722440224470,"stop":1722440224470,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_project_yml","time":{"start":1722440224470,"stop":1722440224470,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies_yml","time":{"start":1722440224471,"stop":1722440224471,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors","time":{"start":1722440224471,"stop":1722440224471,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies","time":{"start":1722440224471,"stop":1722440224471,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter","time":{"start":1722440224471,"stop":1722440225410,"duration":939},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages_yml","time":{"start":1722440224471,"stop":1722440224471,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages","time":{"start":1722440224471,"stop":1722440224471,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors_yml","time":{"start":1722440224471,"stop":1722440224471,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"models","time":{"start":1722440225410,"stop":1722440225410,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"properties","time":{"start":1722440225410,"stop":1722440225410,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"snapshots","time":{"start":1722440225410,"stop":1722440225410,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"macros","time":{"start":1722440225410,"stop":1722440225410,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1722440225410,"stop":1722440225411,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_files","time":{"start":1722440225411,"stop":1722440225411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir","time":{"start":1722440225411,"stop":1722440225412,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tests","time":{"start":1722440225411,"stop":1722440225411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"analyses","time":{"start":1722440225411,"stop":1722440225411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project","time":{"start":1722440225412,"stop":1722440227695,"duration":2283},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_config","time":{"start":1722440225412,"stop":1722440225412,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1722440251222,"stop":1722440251222,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"models","time":{"start":1722440251222,"stop":1722440251222,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1722440278091,"stop":1722440278091,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: Got an unexpected relation type of external for relation base, expected table","statusTrace":"self = <test_basic.TestSimpleMaterializationsFirebolt object at 0x7feee06c8fa0>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7feedfccf370>\n\n    def test_base(self, project):\n    \n        # seed command\n        results = run_dbt([\"seed\"])\n        # seed result length\n        assert len(results) == 1\n    \n        # run command\n        results = run_dbt()\n        # run result length\n        assert len(results) == 3\n    \n        # names exist in result nodes\n        check_result_nodes_by_name(results, [\"view_model\", \"table_model\", \"swappable\"])\n    \n        # check relation types\n        expected = {\n            \"base\": \"table\",\n            \"view_model\": \"view\",\n            \"table_model\": \"table\",\n            \"swappable\": \"table\",\n        }\n>       check_relation_types(project.adapter, expected)\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/adapter/basic/test_base.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nadapter = <dbt.adapters.firebolt.impl.FireboltAdapter object at 0x7feedf374e50>\nrelation_to_type = {'base': 'table', 'swappable': 'table', 'table_model': 'table', 'view_model': 'view'}\n\n    def check_relation_types(adapter, relation_to_type):\n        \"\"\"\n        Relation name to table/view\n        {\n            \"base\": \"table\",\n            \"other\": \"view\",\n        }\n        \"\"\"\n    \n        expected_relation_values = {}\n        found_relations = []\n        schemas = set()\n    \n        for key, value in relation_to_type.items():\n            relation = relation_from_name(adapter, key)\n            expected_relation_values[relation] = value\n            schemas.add(relation.without_identifier())\n    \n            with get_connection(adapter):\n                for schema in schemas:\n                    found_relations.extend(adapter.list_relations_without_caching(schema))\n    \n        for key, value in relation_to_type.items():\n            for relation in found_relations:\n                # this might be too broad\n                if relation.identifier == key:\n>                   assert relation.type == value, (\n                        f\"Got an unexpected relation type of {relation.type} \"\n                        f\"for relation {key}, expected {value}\"\n                    )\nE                   AssertionError: Got an unexpected relation type of external for relation base, expected table\n\n/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/util.py:391: AssertionError","steps":[],"attachments":[{"uid":"44bf5f7b8d6d7c03","name":"log","source":"44bf5f7b8d6d7c03.txt","type":"text/plain","size":24222},{"uid":"8b66002b710dec4b","name":"stdout","source":"8b66002b710dec4b.txt","type":"text/plain","size":2175}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"project::0","time":{"start":1722440249148,"stop":1722440250570,"duration":1422},"status":"broken","statusMessage":"dbt.exceptions.DbtRuntimeError: Runtime Error\n  'type'\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/allure_commons/_allure.py\", line 221, in __call__\n    return self._fixture_function(*args, **kwargs)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/_pytest/fixtures.py\", line 911, in _teardown_yield_fixture\n    next(it)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/fixtures/project.py\", line 537, in project\n    project.drop_test_schema()\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/tests/fixtures/project.py\", line 448, in drop_test_schema\n    self.adapter.drop_schema(relation)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/adapters/sql/impl.py\", line 175, in drop_schema\n    self.execute_macro(DROP_SCHEMA_MACRO_NAME, kwargs=kwargs)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 1112, in execute_macro\n    result = macro_function(**kwargs)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/dbt/adapters/firebolt/connections.py\", line 151, in exception_handler\n    raise DbtRuntimeError(str(e))\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"logs_dir::0","time":{"start":1722440250571,"stop":1722440250571,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter::0","time":{"start":1722440250573,"stop":1722440250574,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml::0","time":{"start":1722440250576,"stop":1722440250576,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter"},{"name":"suite","value":"test_basic"},{"name":"subSuite","value":"TestSimpleMaterializationsFirebolt"},{"name":"host","value":"fv-az1980-421"},{"name":"thread","value":"2223-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.test_basic"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"a5a7775fcff9e1f1.json","parameterValues":[]}