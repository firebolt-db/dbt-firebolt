{"uid":"91c6a94d7a6b0903","name":"test__empty_unique_key_list","fullName":"tests.functional.adapter.incremental.test_incremental.TestUniqueKeyDeleteInsertFirebolt#test__empty_unique_key_list","historyId":"167e5d5572cea639465ef6ee47fce2b5","time":{"start":1748966469469,"stop":1748966477651,"duration":8182},"description":"with no unique keys, seed and model should match","descriptionHtml":"<p>with no unique keys, seed and model should match</p>\n","status":"failed","statusMessage":"AssertionError: Got 2 different rows between seed and empty_unique_key_list","statusTrace":"self = <test_incremental.TestUniqueKeyDeleteInsertFirebolt object at 0x7f3f57397730>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7f3f4fe81cd0>\n\n    def test__empty_unique_key_list(self, project):\n        \"\"\"with no unique keys, seed and model should match\"\"\"\n    \n        expected_fields = self.get_expected_fields(relation=\"seed\", seed_rows=9)\n        test_case_fields = self.get_test_fields(\n            project,\n            seed=\"seed\",\n            incremental_model=\"empty_unique_key_list\",\n            update_sql_file=\"add_new_rows\",\n        )\n>       self.check_scenario_correctness(expected_fields, test_case_fields, project)\n\n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/adapter/incremental/test_incremental_unique_id.py:464: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/adapter/incremental/test_incremental_unique_id.py:411: in check_scenario_correctness\n    check_relations_equal(\n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/util.py:407: in check_relations_equal\n    return check_relations_equal_with_relations(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nadapter = <dbt.adapters.firebolt.impl.FireboltAdapter object at 0x7f3f541aebb0>\nrelations = [<FireboltRelation seed>, <FireboltRelation empty_unique_key_list>]\ncompare_snapshot_cols = False\n\n    def check_relations_equal_with_relations(\n        adapter: Adapter, relations: List, compare_snapshot_cols=False\n    ):\n        with get_connection(adapter):\n            basis, compares = relations[0], relations[1:]\n            # Skip columns starting with \"dbt_\" because we don't want to\n            # compare those, since they are time sensitive\n            # (unless comparing \"dbt_\" snapshot columns is explicitly enabled)\n            column_names = [\n                c.name\n                for c in adapter.get_columns_in_relation(basis)  # type: ignore\n                if not c.name.lower().startswith(\"dbt_\") or compare_snapshot_cols\n            ]\n    \n            for relation in compares:\n                sql = adapter.get_rows_different_sql(basis, relation, column_names=column_names)  # type: ignore\n                _, tbl = adapter.execute(sql, fetch=True)\n                num_rows = len(tbl)\n                assert (\n                    num_rows == 1\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of rows ({num_rows})\"\n                num_cols = len(tbl[0])\n                assert (\n                    num_cols == 2\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of cols ({num_cols})\"\n                row_count_difference = tbl[0][0]\n                assert (\n                    row_count_difference == 0\n                ), f\"Got {row_count_difference} difference in row count betwen {basis} and {relation}\"\n                rows_mismatched = tbl[0][1]\n>               assert (\n                    rows_mismatched == 0\n                ), f\"Got {rows_mismatched} different rows between {basis} and {relation}\"\nE               AssertionError: Got 2 different rows between seed and empty_unique_key_list\n\n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/util.py:459: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"shared_data_dir","time":{"start":1748965703186,"stop":1748965703186,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmpdir_factory","time":{"start":1748965703186,"stop":1748965703186,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data_dir","time":{"start":1748966449085,"stop":1748966449085,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"initialization","time":{"start":1748966459864,"stop":1748966459864,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clean_up_logging","time":{"start":1748966459864,"stop":1748966459864,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"environment","time":{"start":1748966459864,"stop":1748966459864,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_root","time":{"start":1748966459864,"stop":1748966459865,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_root","time":{"start":1748966459865,"stop":1748966459866,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml","time":{"start":1748966459866,"stop":1748966459867,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"unique_schema","time":{"start":1748966459866,"stop":1748966459866,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_data","time":{"start":1748966459866,"stop":1748966459866,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_config_update","time":{"start":1748966459866,"stop":1748966459866,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_profile_target","time":{"start":1748966459866,"stop":1748966459866,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"prefix","time":{"start":1748966459866,"stop":1748966459866,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir","time":{"start":1748966459867,"stop":1748966459867,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter","time":{"start":1748966459868,"stop":1748966459902,"duration":34},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dbt_project_yml","time":{"start":1748966459868,"stop":1748966459868,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1748966459868,"stop":1748966459868,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_setup","time":{"start":1748966459902,"stop":1748966460410,"duration":508},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_config","time":{"start":1748966459902,"stop":1748966459902,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"macros","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors_yml","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"properties","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"models","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"selectors","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dependencies_yml","time":{"start":1748966460411,"stop":1748966460412,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"analyses","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tests","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"snapshots","time":{"start":1748966460411,"stop":1748966460411,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages_yml","time":{"start":1748966460412,"stop":1748966460412,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_files","time":{"start":1748966460412,"stop":1748966460413,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"packages","time":{"start":1748966460412,"stop":1748966460412,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project","time":{"start":1748966460413,"stop":1748966460413,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clean_up","time":{"start":1748966469468,"stop":1748966469468,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_config_update","time":{"start":1748966579030,"stop":1748966579030,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"seeds","time":{"start":1748966579519,"stop":1748966579519,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"with no unique keys, seed and model should match","status":"failed","statusMessage":"AssertionError: Got 2 different rows between seed and empty_unique_key_list","statusTrace":"self = <test_incremental.TestUniqueKeyDeleteInsertFirebolt object at 0x7f3f57397730>\nproject = <dbt.tests.fixtures.project.TestProjInfo object at 0x7f3f4fe81cd0>\n\n    def test__empty_unique_key_list(self, project):\n        \"\"\"with no unique keys, seed and model should match\"\"\"\n    \n        expected_fields = self.get_expected_fields(relation=\"seed\", seed_rows=9)\n        test_case_fields = self.get_test_fields(\n            project,\n            seed=\"seed\",\n            incremental_model=\"empty_unique_key_list\",\n            update_sql_file=\"add_new_rows\",\n        )\n>       self.check_scenario_correctness(expected_fields, test_case_fields, project)\n\n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/adapter/incremental/test_incremental_unique_id.py:464: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/adapter/incremental/test_incremental_unique_id.py:411: in check_scenario_correctness\n    check_relations_equal(\n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/util.py:407: in check_relations_equal\n    return check_relations_equal_with_relations(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nadapter = <dbt.adapters.firebolt.impl.FireboltAdapter object at 0x7f3f541aebb0>\nrelations = [<FireboltRelation seed>, <FireboltRelation empty_unique_key_list>]\ncompare_snapshot_cols = False\n\n    def check_relations_equal_with_relations(\n        adapter: Adapter, relations: List, compare_snapshot_cols=False\n    ):\n        with get_connection(adapter):\n            basis, compares = relations[0], relations[1:]\n            # Skip columns starting with \"dbt_\" because we don't want to\n            # compare those, since they are time sensitive\n            # (unless comparing \"dbt_\" snapshot columns is explicitly enabled)\n            column_names = [\n                c.name\n                for c in adapter.get_columns_in_relation(basis)  # type: ignore\n                if not c.name.lower().startswith(\"dbt_\") or compare_snapshot_cols\n            ]\n    \n            for relation in compares:\n                sql = adapter.get_rows_different_sql(basis, relation, column_names=column_names)  # type: ignore\n                _, tbl = adapter.execute(sql, fetch=True)\n                num_rows = len(tbl)\n                assert (\n                    num_rows == 1\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of rows ({num_rows})\"\n                num_cols = len(tbl[0])\n                assert (\n                    num_cols == 2\n                ), f\"Invalid sql query from get_rows_different_sql: incorrect number of cols ({num_cols})\"\n                row_count_difference = tbl[0][0]\n                assert (\n                    row_count_difference == 0\n                ), f\"Got {row_count_difference} difference in row count betwen {basis} and {relation}\"\n                rows_mismatched = tbl[0][1]\n>               assert (\n                    rows_mismatched == 0\n                ), f\"Got {rows_mismatched} different rows between {basis} and {relation}\"\nE               AssertionError: Got 2 different rows between seed and empty_unique_key_list\n\n/opt/hostedtoolcache/Python/3.9.22/x64/lib/python3.9/site-packages/dbt/tests/util.py:459: AssertionError","steps":[],"attachments":[{"uid":"cadef2c9462ca074","name":"log","source":"cadef2c9462ca074.txt","type":"text/plain","size":32976},{"uid":"b929a0472e2584f9","name":"stdout","source":"b929a0472e2584f9.txt","type":"text/plain","size":2318},{"uid":"9857c4a5003e6f6e","name":"stderr","source":"9857c4a5003e6f6e.txt","type":"text/plain","size":29101}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":3,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"clean_up::0","time":{"start":1748966477668,"stop":1748966480585,"duration":2917},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"project_setup::0","time":{"start":1748966576355,"stop":1748966579012,"duration":2657},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"adapter::0","time":{"start":1748966579013,"stop":1748966579013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"profiles_yml::0","time":{"start":1748966579015,"stop":1748966579015,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logs_dir::0","time":{"start":1748966579015,"stop":1748966579015,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.functional.adapter.incremental"},{"name":"suite","value":"test_incremental"},{"name":"subSuite","value":"TestUniqueKeyDeleteInsertFirebolt"},{"name":"host","value":"pkrvmf6wy0o8zjz"},{"name":"thread","value":"2471-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.functional.adapter.incremental.test_incremental"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"91c6a94d7a6b0903.json","parameterValues":[]}